!function(t){function e(){this._callbacks=[]}function n(t,n,o,a){var i,u,s=new e;o=o||{},a=a||{};try{i=function(){var t;if(window.XMLHttpRequest)t=new XMLHttpRequest;else if(window.ActiveXObject)try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){t=new ActiveXObject("Microsoft.XMLHTTP")}return t}()}catch(t){return s.done(r.ENOXHR,""),s}u=function(t){var e="";if("string"==typeof t)e=t;else{var n=encodeURIComponent,o=[];for(var r in t)t.hasOwnProperty(r)&&o.push(n(r)+"="+n(t[r]));e=o.join("&")}return e}(o),"GET"===t&&u&&(n+="?"+u,u=null),i.open(t,n);var c="application/x-www-form-urlencoded";for(var f in a)a.hasOwnProperty(f)&&("content-type"===f.toLowerCase()?c=a[f]:i.setRequestHeader(f,a[f]));i.setRequestHeader("Content-type",c);var l=r.ajaxTimeout;if(l)var p=setTimeout(function(){i.abort(),s.done(r.ETIMEOUT,"",i)},l);return i.onreadystatechange=function(){if(l&&clearTimeout(p),4===i.readyState){var t=!i.status||(i.status<200||i.status>=300)&&304!==i.status;s.done(t,i.responseText,i)}},i.send(u),s}function o(t){return function(e,o,r){return n(t,e,o,r)}}e.prototype.then=function(t,n){var o;return this._isdone?o=t.apply(n,this.result):(o=new e,this._callbacks.push(function(){var e=t.apply(n,arguments);e&&"function"==typeof e.then&&e.then(o.done,o)})),o},e.prototype.done=function(){this.result=arguments,this._isdone=!0;for(var t=0;t<this._callbacks.length;t++)this._callbacks[t].apply(null,arguments);this._callbacks=[]};var r={Promise:e,join:function(t){var n=new e,o=[];if(!t||!t.length)return n.done(o),n;var r=0,a=t.length;function i(t){return function(){r+=1,o[t]=Array.prototype.slice.call(arguments),r===a&&n.done(o)}}for(var u=0;u<a;u++)t[u].then(i(u));return n},chain:function t(n,o){var r=new e;return 0===n.length?r.done.apply(r,o):n[0].apply(null,o).then(function(){n.splice(0,1),t(n,arguments).then(function(){r.done.apply(r,arguments)})}),r},ajax:n,get:o("GET"),post:o("POST"),put:o("PUT"),del:o("DELETE"),ENOXHR:1,ETIMEOUT:2,ajaxTimeout:0};"function"==typeof define&&define.amd?define(function(){return r}):t.promise=r}(this);