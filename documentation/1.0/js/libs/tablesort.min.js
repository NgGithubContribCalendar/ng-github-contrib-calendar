!function(){function t(e,n){if(!(this instanceof t))return new t(e,n);if(!e||"TABLE"!==e.tagName)throw new Error("Element must be a table");this.init(e,n||{})}var e=[],n=function(t){var e;return window.CustomEvent&&"function"==typeof window.CustomEvent?e=new CustomEvent(t):(e=document.createEvent("CustomEvent")).initCustomEvent(t,!1,!1,void 0),e},r=function(t){return t.getAttribute("data-sort")||t.textContent||t.innerText||""},o=function(t,e){return(t=t.toLowerCase())===(e=e.toLowerCase())?0:t<e?1:-1},i=function(t,e){return function(n,r){var o=t(n.td,r.td);return 0===o?e?r.index-n.index:n.index-r.index:o}};t.extend=function(t,n,r){if("function"!=typeof n||"function"!=typeof r)throw new Error("Pattern and sort must be a function");e.push({name:t,pattern:n,sort:r})},t.prototype={init:function(t,e){var n,r,o,i,s=this;if(s.table=t,s.thead=!1,s.options=e,t.rows&&t.rows.length>0)if(t.tHead&&t.tHead.rows.length>0){for(o=0;o<t.tHead.rows.length;o++)if("thead"===t.tHead.rows[o].getAttribute("data-sort-method")){n=t.tHead.rows[o];break}n||(n=t.tHead.rows[t.tHead.rows.length-1]),s.thead=!0}else n=t.rows[0];if(n){var a=function(){s.current&&s.current!==this&&s.current.removeAttribute("aria-sort"),s.current=this,s.sortTable(this)};for(o=0;o<n.cells.length;o++)(i=n.cells[o]).setAttribute("role","columnheader"),"none"!==i.getAttribute("data-sort-method")&&(i.tabindex=0,i.addEventListener("click",a,!1),null!==i.getAttribute("data-sort-default")&&(r=i));r&&(s.current=r,s.sortTable(r))}},sortTable:function(t,s){var a=this,d=t.cellIndex,u=o,l="",f=[],c=a.thead?0:1,h=t.getAttribute("data-sort-method"),b=t.getAttribute("aria-sort");if(a.table.dispatchEvent(n("beforeSort")),s||(b="ascending"===b?"descending":"descending"===b?"ascending":a.options.descending?"ascending":"descending",t.setAttribute("aria-sort",b)),!(a.table.rows.length<2)){if(!h){for(;f.length<3&&c<a.table.tBodies[0].rows.length;)(l=(l=r(a.table.tBodies[0].rows[c].cells[d])).trim()).length>0&&f.push(l),c++;if(!f)return}for(c=0;c<e.length;c++)if(l=e[c],h){if(l.name===h){u=l.sort;break}}else if(f.every(l.pattern)){u=l.sort;break}for(a.col=d,c=0;c<a.table.tBodies.length;c++){var g,w=[],m={},v=0,p=0;if(!(a.table.tBodies[c].rows.length<2)){for(g=0;g<a.table.tBodies[c].rows.length;g++)"none"===(l=a.table.tBodies[c].rows[g]).getAttribute("data-sort-method")?m[v]=l:w.push({tr:l,td:r(l.cells[a.col]),index:v}),v++;for("descending"===b?(w.sort(i(u,!0)),w.reverse()):w.sort(i(u,!1)),g=0;g<v;g++)m[g]?(l=m[g],p++):l=w[g-p].tr,a.table.tBodies[c].appendChild(l)}}a.table.dispatchEvent(n("afterSort"))}},refresh:function(){void 0!==this.current&&this.sortTable(this.current,!0)}},"undefined"!=typeof module&&module.exports?module.exports=t:window.Tablesort=t}();